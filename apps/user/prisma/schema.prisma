

generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "debian-openssl-1.1.x", "linux-musl-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Provider {
  google
  github
}

model UserAccount {
  id                           String         @id @default(uuid())
  userName                     String         @unique
  email                        String         @unique
  passwordHash                 String?
  confirmationCode             String?
  confirmationExpDate          DateTime?
  isConfirmed                  Boolean
  provider                     Provider? 
  providerId                   String?        @unique
  passwordRecoveryCode         String?
  passwordRecoveryExpDate      DateTime?
  createdAt                    DateTime       @default(now())
  updatedAt                    DateTime       @updatedAt

  userSessions                 UserSession[]  @relation("UserSessions")
  userProfile                  UserProfile?
}

model UserSession {
  id                String         @id @default(uuid())
  ip                String
  userAgentInfo     String         
  deviceId          String         @unique
  refreshToken      String         
  rtIssuedAt        DateTime       
  rtExpirationDate  DateTime  
  createdAt         DateTime       @default(now())
     

  userAccount       UserAccount    @relation("UserSessions", fields: [userId], references: [id])
  userId            String
}

model UserProfile {
  id                String         @id @default(uuid())
  userName          String         @unique
  firstName         String        
  lastName          String
  birthDate         DateTime
  country           String?
  city              String?
  about             String?        @db.VarChar(255)
  createdAt         DateTime       @default(now())

  userAccount       UserAccount    @relation(fields: [userId], references: [id])
  userId            String         @unique
}